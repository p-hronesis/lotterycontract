{"ast":null,"code":"var _jsxFileName = \"D:\\\\PROJECTS\\\\lottery_game\\\\lotterygame\\\\src\\\\App.js\",\n    _s = $RefreshSig$();\n\n// import logo from './logo.svg';\nimport './App.css';\nimport Menu from './components/Menu';\nimport { Header } from './components/Header';\nimport RecentWinners from './components/RecentWinners';\nimport HowItWorks from './components/HowItWorks';\nimport Faqs from './components/Faq';\nimport Web3 from 'web3';\nimport abi from \"./abi/lottery.json\";\nimport { useEffect, useState } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst INFURA_ENDPOINT = \"https://rinkeby.infura.io/v3/c95d9276d5e041acbe6411cdda48275e\";\n\nfunction App() {\n  _s();\n\n  const LotteryContractAddress = '0x65fd425aD3f20835662A9447677A7df40055EF68';\n  const [recentWinners, setrecentWinners] = useState([]);\n  const [isConnected, setisConnected] = useState(false);\n  const [accounts, setAccounts] = useState([]);\n  const [lotteryContract, setlotteryContract] = useState();\n  const [web3, setWeb3] = useState();\n  const [lotteryState, setlotteryState] = useState();\n  useEffect(() => {\n    const web3_temp = new Web3(INFURA_ENDPOINT);\n    setWeb3(web3_temp);\n    const lotteryContract = new web3_temp.eth.Contract(abi, LotteryContractAddress);\n    setlotteryContract(lotteryContract);\n    connectMetaMask();\n    detectMetaMaskAccountChange();\n    getRecentWinners(lotteryContract);\n    getLotteryState(lotteryContract);\n  }, []);\n\n  async function detectMetaMaskAccountChange() {\n    window.ethereum.on(\"accountsChanged\", async function () {\n      console.log('you changed the currently selected account'); // Time to reload your interface with accounts[0]!\n\n      const web3 = new Web3(Web3.givenProvider); // console.log('these are the new account')\n      // console.log(await web3.eth.getAccounts());\n\n      web3.eth.getAccounts().then(response => {\n        setAccounts(response); // console.log(accounts);\n\n        if (!accounts[0]) {\n          // setisConnected(false)\n          console.log('no account is connected');\n        }\n      });\n    });\n  }\n\n  function getRecentWinners(lotteryContract) {\n    lotteryContract.methods.lottery_count().call().then(lotteryCount => {\n      // console.log('Lottery Count: ' + lotteryCount)\n      const recentWinnerstemp = [];\n      var countTemp = lotteryCount;\n\n      while (lotteryCount > 0) {\n        lotteryContract.methods.recentWinners(lotteryCount).call().then(response => {\n          // console.log(response)\n          recentWinnerstemp.push(response);\n          countTemp--;\n\n          if (countTemp == 0) {\n            // console.log(\"pppppppppp\")\n            console.log('Recent winners retrieved succesfully'); // setisConnected(connectMetaMask())\n\n            setrecentWinners(recentWinnerstemp); // console.log(recentWinners)\n          }\n        }, error => {\n          console.log(error);\n        });\n        lotteryCount--;\n      }\n    }, error => {\n      console.log(error); // console.log(\"hhhhhhh\")\n    });\n  } // useEffect(() => {\n  //   if (Web3.givenProvider) {\n  //     const web3 = new Web3(Web3.givenProvider);\n  //     web3.eth.getAccounts().then(setAccounts);\n  //     setisConnected(true)\n  //   }\n  // }, [])\n\n\n  function getLotteryState(lotteryContract) {\n    lotteryContract.methods.lottery_state().call().then(response => {\n      // console.log('attempting to get lottery contract state')\n      // console.log(response)\n      // console.log('attempting to get lottery contract state')\n      switch (response) {\n        case '0':\n          setlotteryState(\"Ended/Not Started\");\n          break;\n\n        case '1':\n          setlotteryState(\"Ongoing\");\n          break;\n\n        case '2':\n          setlotteryState(\"Calculating winner, please wait\");\n          break;\n\n        default:\n          setlotteryState(\"Unknown!\");\n          break;\n      }\n    }, error => {\n      console.log(error);\n    });\n  }\n\n  function endLottery() {\n    const web3 = new Web3(INFURA_ENDPOINT);\n    const lotteryContract = new web3.eth.Contract(abi, LotteryContractAddress);\n    const lotteryOwnerAddress = \"0x281B3B65AE71fc4EBBa61325a6bC2974B80F04c2\";\n    var lotteryContractOwner = web3.eth.accounts.privateKeyToAccount('0x65cde2fe2e5f7c84d33f6e1b25585ff2469b5704d43e1c18a72b5b6978aef57a');\n    web3.eth.getTransactionCount(lotteryOwnerAddress, async (err, txCount) => {\n      // Build the transaction\n      // console.log(txCount)\n      // console.log(lotteryContractOwner.privateKey)\n      // console.log(lotteryContractOwner)\n      const txObject = {\n        nonce: txCount,\n        to: LotteryContractAddress,\n        // value: web3.utils.toHex(web3.utils.toWei('20', 'ether')),\n        gasLimit: 300000,\n        gasPrice: web3.utils.toHex(web3.utils.toWei('10', 'gwei')),\n        chainId: 4,\n        data: lotteryContract.methods.endLottery().encodeABI()\n      };\n      const signedTx = await web3.eth.accounts.signTransaction(txObject, lotteryContractOwner.privateKey);\n      console.log('attempting to send signed transaction');\n      web3.eth.sendSignedTransaction(signedTx.rawTransaction, function (error, hash) {\n        if (!error) {\n          console.log(\"🎉 The hash of your transaction is: \", hash, \"\\n Check Infura's Mempool to view the status of your transaction!\");\n        } else {\n          console.log(\"❗Something went wrong while submitting your transaction:\", error);\n        }\n      }).then(response => {\n        setlotteryState(\"Ended/Not Started\");\n        console.log('this is the transaction receipt');\n        console.log(response);\n      }, error => {\n        console.log('this is the transaction error receipt');\n        console.log(error);\n      });\n    }); // console.log('Attempting to end lottery')\n  }\n\n  function startLottery() {\n    const web3 = new Web3(INFURA_ENDPOINT);\n    const lotteryContract = new web3.eth.Contract(abi, LotteryContractAddress);\n    const lotteryOwnerAddress = \"0x281B3B65AE71fc4EBBa61325a6bC2974B80F04c2\";\n    var lotteryContractOwner = web3.eth.accounts.privateKeyToAccount('0x65cde2fe2e5f7c84d33f6e1b25585ff2469b5704d43e1c18a72b5b6978aef57a');\n    web3.eth.getTransactionCount(lotteryOwnerAddress, async (err, txCount) => {\n      // Build the transaction\n      // console.log(txCount)\n      // console.log(lotteryContractOwner.privateKey)\n      // console.log(lotteryContractOwner)\n      const txObject = {\n        nonce: txCount,\n        to: LotteryContractAddress,\n        // value: web3.utils.toHex(web3.utils.toWei('20', 'ether')),\n        gasLimit: 300000,\n        gasPrice: web3.utils.toHex(web3.utils.toWei('10', 'gwei')),\n        chainId: 4,\n        data: lotteryContract.methods.startLottery().encodeABI()\n      };\n      const signedTx = await web3.eth.accounts.signTransaction(txObject, lotteryContractOwner.privateKey);\n      console.log('attempting to send signed transaction');\n      web3.eth.sendSignedTransaction(signedTx.rawTransaction, function (error, hash) {\n        if (!error) {\n          console.log(\"🎉 The hash of your transaction is: \", hash, \"\\n Check Infura's Mempool to view the status of your transaction!\");\n        } else {\n          console.log(\"❗Something went wrong while submitting your transaction:\", error);\n        }\n      }).then(response => {\n        setlotteryState(\"Ongoing\");\n        console.log('this is the transaction receipt');\n        console.log(response);\n      }, error => {\n        console.log('this is the transaction error receipt');\n        console.log(error);\n      });\n    }); // console.log('Attempting to start lottery')\n  }\n\n  function enterLottery() {\n    // console.log('attempting to enter lottery')\n    // console.log(isConnected)\n    const web3 = new Web3(Web3.givenProvider);\n    const lotteryContract = new web3.eth.Contract(abi, LotteryContractAddress);\n    lotteryContract.methods.entranceFeeInWei().call().then(response => {\n      // console.log(response)\n      // console.log(accounts)\n      lotteryContract.methods.enter().send({\n        from: accounts[0],\n        value: response * 1.05\n      }).then(response => {\n        console.log('Entered lottery succesfully'); // console.log(response)\n      }, errorii => {\n        console.log('An error occured while attempting to enter lottery');\n        console.log(errorii);\n      });\n    }, error => {\n      console.log('error retrieving the entrance fee in wei' + error);\n    });\n  }\n\n  const connectMetaMask = async () => {\n    console.log(\"attempting to connect metamask\");\n\n    if (window.ethereum) {\n      try {\n        Web3.givenProvider.send('eth_requestAccounts').then(response => {\n          setAccounts(response.result); // console.log('There was no error connecting to metamask')\n\n          setisConnected(true);\n          return true;\n        });\n      } catch (error) {\n        console.log('There was an error connecting to metamask');\n        return false;\n      }\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Menu, {\n      id: \"Home\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Header, {\n      account: accounts[0],\n      endLottery: endLottery,\n      startLottery: startLottery,\n      enterLottery: enterLottery,\n      connectMetaMask: connectMetaMask,\n      isConnected: isConnected,\n      lotteryState: lotteryState\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n      children: /*#__PURE__*/_jsxDEV(RecentWinners, {\n        recentWinners: recentWinners\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(HowItWorks, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 259,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 253,\n    columnNumber: 5\n  }, this);\n}\n\n_s(App, \"yV8gWzEWmye5C2mrSKouk4eEYAo=\");\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["D:/PROJECTS/lottery_game/lotterygame/src/App.js"],"names":["Menu","Header","RecentWinners","HowItWorks","Faqs","Web3","abi","useEffect","useState","INFURA_ENDPOINT","App","LotteryContractAddress","recentWinners","setrecentWinners","isConnected","setisConnected","accounts","setAccounts","lotteryContract","setlotteryContract","web3","setWeb3","lotteryState","setlotteryState","web3_temp","eth","Contract","connectMetaMask","detectMetaMaskAccountChange","getRecentWinners","getLotteryState","window","ethereum","on","console","log","givenProvider","getAccounts","then","response","methods","lottery_count","call","lotteryCount","recentWinnerstemp","countTemp","push","error","lottery_state","endLottery","lotteryOwnerAddress","lotteryContractOwner","privateKeyToAccount","getTransactionCount","err","txCount","txObject","nonce","to","gasLimit","gasPrice","utils","toHex","toWei","chainId","data","encodeABI","signedTx","signTransaction","privateKey","sendSignedTransaction","rawTransaction","hash","startLottery","enterLottery","entranceFeeInWei","enter","send","from","value","errorii","result"],"mappings":"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","sourcesContent":["// import logo from './logo.svg';\nimport './App.css';\nimport Menu from './components/Menu';\nimport { Header } from './components/Header';\nimport RecentWinners from './components/RecentWinners';\nimport HowItWorks from './components/HowItWorks';\nimport Faqs from './components/Faq';\nimport Web3 from 'web3';\nimport abi from \"./abi/lottery.json\"\nimport { useEffect, useState } from 'react';\nconst INFURA_ENDPOINT = \"https://rinkeby.infura.io/v3/c95d9276d5e041acbe6411cdda48275e\"\nfunction App() {\n\n  const LotteryContractAddress = '0x65fd425aD3f20835662A9447677A7df40055EF68'\n  const [recentWinners, setrecentWinners] = useState([]);\n  const [isConnected, setisConnected] = useState(false);\n  const [accounts, setAccounts] = useState([]);\n  const [lotteryContract, setlotteryContract] = useState();\n  const [web3, setWeb3] = useState()\n  const [lotteryState, setlotteryState] = useState()\n\n  useEffect(() => {\n    const web3_temp = new Web3(INFURA_ENDPOINT)\n    setWeb3(web3_temp)\n    const lotteryContract = new web3_temp.eth.Contract(abi, LotteryContractAddress)\n    setlotteryContract(lotteryContract)\n    connectMetaMask()\n    detectMetaMaskAccountChange();\n    getRecentWinners(lotteryContract)\n    getLotteryState(lotteryContract)\n  }, []);\n\n  async function detectMetaMaskAccountChange() {\n    window.ethereum.on(\"accountsChanged\", async function () {\n      console.log('you changed the currently selected account')\n      // Time to reload your interface with accounts[0]!\n      const web3 = new Web3(Web3.givenProvider);\n      // console.log('these are the new account')\n      // console.log(await web3.eth.getAccounts());\n      web3.eth.getAccounts().then(\n        (response) => {\n          setAccounts(response)\n          // console.log(accounts);\n          if (!accounts[0]) {\n            // setisConnected(false)\n            console.log('no account is connected')\n          }\n        }\n      )\n\n    });\n  }\n\n  function getRecentWinners(lotteryContract) {\n    lotteryContract.methods.lottery_count().call().then((lotteryCount) => {\n      // console.log('Lottery Count: ' + lotteryCount)\n      const recentWinnerstemp = []\n      var countTemp = lotteryCount\n      while (lotteryCount > 0) {\n        lotteryContract.methods.recentWinners(lotteryCount).call().then((response) => {\n          // console.log(response)\n          recentWinnerstemp.push(response)\n          countTemp--\n          if (countTemp == 0) {\n            // console.log(\"pppppppppp\")\n            console.log('Recent winners retrieved succesfully')\n            // setisConnected(connectMetaMask())\n            setrecentWinners(recentWinnerstemp)\n            // console.log(recentWinners)\n\n          }\n        }, (error) => {\n          console.log(error)\n        })\n\n        lotteryCount--\n      }\n\n    }, (error) => {\n      console.log(error)\n      // console.log(\"hhhhhhh\")\n    })\n  }\n\n  // useEffect(() => {\n  //   if (Web3.givenProvider) {\n  //     const web3 = new Web3(Web3.givenProvider);\n  //     web3.eth.getAccounts().then(setAccounts);\n  //     setisConnected(true)\n  //   }\n  // }, [])\n  function getLotteryState(lotteryContract) {\n    lotteryContract.methods.lottery_state().call().then((response) => {\n      // console.log('attempting to get lottery contract state')\n      // console.log(response)\n      // console.log('attempting to get lottery contract state')\n\n      switch (response) {\n        case '0':\n          setlotteryState(\"Ended/Not Started\")\n          break;\n        case '1':\n          setlotteryState(\"Ongoing\")\n          break;\n        case '2':\n          setlotteryState(\"Calculating winner, please wait\")\n          break;\n        default:\n          setlotteryState(\"Unknown!\")\n          break;\n      }\n    }, (error) => {\n      console.log(error)\n    })\n  }\n  function endLottery() {\n    const web3 = new Web3(INFURA_ENDPOINT);\n    const lotteryContract = new web3.eth.Contract(abi, LotteryContractAddress);\n    const lotteryOwnerAddress = \"0x281B3B65AE71fc4EBBa61325a6bC2974B80F04c2\"\n    var lotteryContractOwner = web3.eth.accounts.privateKeyToAccount('0x65cde2fe2e5f7c84d33f6e1b25585ff2469b5704d43e1c18a72b5b6978aef57a');\n\n    web3.eth.getTransactionCount(lotteryOwnerAddress, async (err, txCount) => {\n      // Build the transaction\n      // console.log(txCount)\n      // console.log(lotteryContractOwner.privateKey)\n      // console.log(lotteryContractOwner)\n      const txObject = {\n        nonce: txCount,\n        to: LotteryContractAddress,\n        // value: web3.utils.toHex(web3.utils.toWei('20', 'ether')),\n        gasLimit: 300000,\n        gasPrice: web3.utils.toHex(web3.utils.toWei('10', 'gwei')),\n        chainId: 4,\n        data: lotteryContract.methods.endLottery().encodeABI()\n      }\n\n      const signedTx = await web3.eth.accounts.signTransaction(txObject, lotteryContractOwner.privateKey);\n\n      console.log('attempting to send signed transaction')\n      web3.eth.sendSignedTransaction(signedTx.rawTransaction, function (error, hash) {\n        if (!error) {\n          console.log(\"🎉 The hash of your transaction is: \", hash, \"\\n Check Infura's Mempool to view the status of your transaction!\");\n\n        } else {\n          console.log(\"❗Something went wrong while submitting your transaction:\", error)\n        }\n      }).then((response) => {\n        setlotteryState(\"Ended/Not Started\")\n        console.log('this is the transaction receipt')\n        console.log(response)\n      },\n        (error) => {\n          console.log('this is the transaction error receipt')\n          console.log(error)\n        }\n      )\n    })\n\n    // console.log('Attempting to end lottery')\n  }\n\n  function startLottery() {\n\n    const web3 = new Web3(INFURA_ENDPOINT);\n    const lotteryContract = new web3.eth.Contract(abi, LotteryContractAddress);\n    const lotteryOwnerAddress = \"0x281B3B65AE71fc4EBBa61325a6bC2974B80F04c2\"\n    var lotteryContractOwner = web3.eth.accounts.privateKeyToAccount('0x65cde2fe2e5f7c84d33f6e1b25585ff2469b5704d43e1c18a72b5b6978aef57a');\n\n    web3.eth.getTransactionCount(lotteryOwnerAddress, async (err, txCount) => {\n      // Build the transaction\n      // console.log(txCount)\n      // console.log(lotteryContractOwner.privateKey)\n      // console.log(lotteryContractOwner)\n      const txObject = {\n        nonce: txCount,\n        to: LotteryContractAddress,\n        // value: web3.utils.toHex(web3.utils.toWei('20', 'ether')),\n        gasLimit: 300000,\n        gasPrice: web3.utils.toHex(web3.utils.toWei('10', 'gwei')),\n        chainId: 4,\n        data: lotteryContract.methods.startLottery().encodeABI()\n      }\n\n      const signedTx = await web3.eth.accounts.signTransaction(txObject, lotteryContractOwner.privateKey);\n\n      console.log('attempting to send signed transaction')\n      web3.eth.sendSignedTransaction(signedTx.rawTransaction, function (error, hash) {\n        if (!error) {\n          console.log(\"🎉 The hash of your transaction is: \", hash, \"\\n Check Infura's Mempool to view the status of your transaction!\");\n\n        } else {\n          console.log(\"❗Something went wrong while submitting your transaction:\", error)\n        }\n      }).then((response) => {\n        setlotteryState(\"Ongoing\")\n        console.log('this is the transaction receipt')\n        console.log(response)\n      },\n        (error) => {\n          console.log('this is the transaction error receipt')\n          console.log(error)\n        }\n      )\n    })\n    // console.log('Attempting to start lottery')\n\n  }\n\n  function enterLottery() {\n    // console.log('attempting to enter lottery')\n    // console.log(isConnected)\n    const web3 = new Web3(Web3.givenProvider);\n    const lotteryContract = new web3.eth.Contract(abi, LotteryContractAddress);\n    lotteryContract.methods.entranceFeeInWei().call().then((response) => {\n      // console.log(response)\n      // console.log(accounts)\n      lotteryContract.methods.enter().send({ from: accounts[0], value: response * 1.05 }).then(\n        (response) => {\n          console.log('Entered lottery succesfully')\n          // console.log(response)\n        },\n        (errorii) => {\n          console.log('An error occured while attempting to enter lottery')\n          console.log(errorii)\n        }\n      )\n    },\n      (error) => {\n        console.log('error retrieving the entrance fee in wei' + error)\n      })\n\n  }\n\n  const connectMetaMask = async () => {\n    console.log(\"attempting to connect metamask\")\n    if (window.ethereum) {\n      try {\n        Web3.givenProvider.send('eth_requestAccounts')\n          .then((response) => {\n            setAccounts(response.result)\n            // console.log('There was no error connecting to metamask')\n            setisConnected(true)\n            return true;\n          });\n      } catch (error) {\n        console.log('There was an error connecting to metamask')\n        return false;\n      }\n    }\n  }\n\n  return (\n    <div>\n      <Menu id={\"Home\"} />\n      <Header account={accounts[0]} endLottery={endLottery} startLottery={startLottery} enterLottery={enterLottery} connectMetaMask={connectMetaMask} isConnected={isConnected} lotteryState={lotteryState} />\n      <table>\n        <RecentWinners recentWinners={recentWinners} />\n      </table>\n      <HowItWorks />\n      {/* <div className=\"App\">\n        <header className=\"App-header\">\n          <Menu />\n        </header>\n      </div> */}\n    </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}